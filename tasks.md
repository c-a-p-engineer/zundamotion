# 📋 Zundamotion タスク一覧（統合版）

---

## 🚨 P0（最優先：基盤安定 + 必須機能）

### 2. timebase統一

* **ゴール**: 長時間動画でも字幕・SE・口パクがズレない
* **背景**: fps/ptsのズレで長尺動画のタイミングが狂う
* **実装イメージ**:

  * `setpts`と`aresample=48000`で補正
  * 全素材を内部規格fps（30fps想定）に統一

---

### 3. BGM管理強化（継続・クロスフェード）

* **ゴール**: シーンまたぎでもBGMが途切れず、自然に繋がる
* **背景**: 今はシーンごとにBGMが途切れる
* **実装イメージ**:

  * YAML:

    ```yaml
    bgm:
      continue: true
      crossfade: 1.0
    ```
  * 内部でBGMを全体一本化 → シーン境界でacrossfade

---

### 4. LUFS正規化 & 自動デュッキング

* **ゴール**: セリフがBGMに埋もれず聞きやすい
* **背景**: VOICEVOX音声とBGMの音量バランスに差がある
* **実装イメージ**:

  * `loudnorm`で-14〜-16 LUFSに正規化
  * `sidechaincompress`でセリフ中はBGM音量を下げる

---

### 5. 字幕テンプレート（標準スタイル）

* **ゴール**: デフォルト状態で見やすい字幕（YMM風）を出せる
* **背景**: 白字＋黒縁＋影が標準的で認識性が高い
* **実装イメージ**:

  * `templates/subtitle_default.yaml`を用意
  * `drawtext`で縁取り・影・下寄せ

---

### 6. 字幕キャラ別デフォルト

* **ゴール**: キャラごとに字幕の色・フォントなどを指定できる
* **背景**: ずんだもん=緑、めたん=紫など色分けしたい
* **実装イメージ**:

  * YAML:

    ```yaml
    defaults:
      characters:
        zundamon:
          subtitle:
            color: green
            outline: black
    ```

---

### 7. キャラデフォルト管理

* **ゴール**: 声質・字幕スタイル・表情をキャラ単位でまとめる
* **背景**: 毎回記述するのは冗長
* **実装イメージ**:

  * YAML:

    ```yaml
    defaults:
      characters:
        zundamon:
          voice: 3
          pitch: 0
          speed: 1.0
    ```

---

### 8. CLI完成度アップ

* **ゴール**: README記載のコマンドがすべて動作する
* **背景**: 現在はオプション不足
* **実装イメージ**:

  * `--scene` 指定
  * `--preview N` プレビュー出力
  * `--ratio 16:9|9:16|1:1` アスペクト変更

---

### 9. 動画サイズ指定（縦横解像度）

* **ゴール**: 出力解像度や縦横比を自由に指定できる
* **背景**: Shorts用や正方形動画が欲しいケースがある
* **実装イメージ**:

  * `meta: resolution: "1920x1080", aspect_ratio: "16:9"`

---

### 10. タイムライン表出力

* **ゴール**: シーン開始時間・セリフ開始時間をテキストで出力
* **背景**: YouTube説明欄のチャプターに流用したい
* **実装イメージ**:

  * 出力: `.csv` または `.md`
  * 例:

    ```
    0:00 - OP開始
    0:05 - ずんだもん「こんにちは！」
    ```

---

### 11. 使用VoiceVox情報出力

* **ゴール**: 各キャラがどのID・ピッチ・速度を使ったか記録
* **背景**: 後から声質を変更するときの参照に必要
* **実装イメージ**:

  * `voice_report.md`を出力
  * `Zundamon: VOICEVOX ID=3, Pitch=0, Speed=1.0`

---

---

## ⚡ P1（次のスプリント：演出・効率強化）

### 12. 複数キャラ掛け合い & ワイプ表示

* **ゴール**: 2キャラ以上が同時に登場・対話可能
* **背景**: 解説動画や茶番で必須
* **実装イメージ**:

  * YAML:

    ```yaml
    - char: zundamon
      text: "こんにちは！"
      position: left
    - char: metan
      text: "元気だね！"
      position: right
    ```

---

### 13. キャラアニメーション（入退場・動き）

* **ゴール**: キャラがスライド/拡大/揺れなどで登場
* **背景**: 静止表示では単調
* **実装イメージ**:

  ```yaml
  effects:
    - type: slide_in
      from: left
      dur: 0.5
  ```

---

### 14. シナリオ記法（二段構え）

* **ゴール**: シンプルにも、詳細にも記述できる
* **背景**: 初心者と上級者の両対応が必要
* **実装イメージ**:

  * シンプル:

    ```yaml
    - char: zundamon
      text: "こんにちは！"
    ```
  * 詳細:

    ```yaml
    - char: zundamon
      text: "こんにちは！"
      expression: happy
      position: left
    ```

---

### 15. SE相対トリガー

* **ゴール**: 効果音をセリフの開始/終了に相対指定できる
* **背景**: ネタ演出に必須
* **実装イメージ**:

  ```yaml
  se:
    path: se/pon.wav
    at: line_end - 0.2s
  ```

---

### 16. 素材リゾルバ

* **ゴール**: 不足素材を一覧表示して効率化
* **背景**: 実行途中で落ちるのは不便
* **実装イメージ**:

  * 実行前に `assets/` をチェックし、不足を警告

---

### 17. 進捗バー + ETA

* **ゴール**: 処理時間を見積もれる
* **背景**: 長尺動画では進行状況が欲しい
* **実装イメージ**:

  * `tqdm`風の進捗表示
  * ETA ±20%精度

---

### 18. 例外ポリシー定義

* **ゴール**: エラー発生時の挙動を統一する
* **背景**: 効果音欠落=警告、BGM欠落=停止などルール必要
* **実装イメージ**:

  * `--strict` オプションで厳格化

---

---

## 🌱 P2（拡張・OSS配布）

### 19. YouTube Shorts自動変換

* **ゴール**: 16:9動画を9:16に変換、キャラ・字幕も再配置
* **背景**: 同じ動画をShorts用に使いたい
* **実装イメージ**:

  * `--profile yt_shorts`

---

### 20. 拡張トランジション

* **ゴール**: wipe / slide / dissolve を追加
* **背景**: フェードだけでは単調
* **実装イメージ**:

  * YAML: `transition: wipeleft`

---

### 21. 自動サムネイル出力

* **ゴール**: 動画からサムネ候補を生成
* **背景**: YouTubeで必須
* **実装イメージ**:

  * シーン切替でフレームをキャプチャ＋テキスト合成

---

### 22. PyPI / Docker / CI整備

* **ゴール**: OSSとして配布しやすくする
* **背景**: 利用者を増やすため
* **実装イメージ**:

  * `pip install zundamotion`
  * Dockerイメージ提供
  * GitHub ActionsでE2Eテスト

---

### 23. タスク出力（JSON/CSVログ）

* **ゴール**: どの素材をどこで使ったかを記録
* **背景**: 再現性と外部連携
* **実装イメージ**:

  * JSONログにキャラ・時間・素材情報を出力

---

### 24. Viseme対応 & VRM連動（長期）

* **ゴール**: 自然な口パク・3Dキャラ対応
* **背景**: 総合映像エンジンとして発展させるため
* **実装イメージ**:

  * VOICEVOXの音素から口形推定
  * VRMモーション制御
